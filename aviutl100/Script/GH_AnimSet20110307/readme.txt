
---------------------------------------------------------------------------
AviUtl拡張編集プラグインの「アニメーション効果」用Luaスクリプトセット「GH_AnimSet」

　■初版作成日：2011/02/09
　■最終更新日：2011/03/07 （更新履歴は末尾に記載）
　■作成者：金の髭

---------------------------------------------------------------------------

■概要
　　AviUtlの拡張編集プラグインの「アニメーション効果」フィルタに
　　アニメーションパターンを登録するanmファイルです。
　　anmファイルの中身はLuaスクリプトなのでメモ帳などで開けばスクリプトの書き換えなどが可能です。
　　拡張編集とLuaについては拡張編集プラグインに同梱されているドキュメントを参照して下さい。
　　末尾に示した参考サイトなどもご覧下さい。

■解説動画
　　ニコニコ動画で「GH_AnimSet」でタグ検索すれば見つかるやも。
　　ただし必ず最新版の解説動画があるかどうかはわかりません。

■使用したAviUtlのバージョン
　　0.99i8

■使用した拡張編集プラグインのバージョン
　　0.87f

　　※基本的には0.87e以降で動作しますが、0.87fで拡張編集のポリゴン描画処理が
　　　　大幅に改善されたので、0.87fを使うことを推奨します。

　　※多角柱マッピングは、0.87fで実装された「引数なしのobj.effect()呼び出し」を使っているため
　　　　0.87f以降でないと動作しません。

■注意

　●スクリプトファイルはバージョンアップによる仕様変更などにより使えなくなったり
　　 想定した動作をしなくなったりする可能性もあります。
　　 上に示したバージョンの組み合わせでしか動作確認していないのでご注意ください。

　●今後デフォルトのアニメーションパターンが増えたらお役御免になるかも。

　●作者はLuaをまともに勉強してません。サンプルや解説を見て適当にググって作ってます。
　　 基本的に初心者レベルなので処理効率とかもあまり考えてません。
　　 保証なども一切ありませんので、自己責任で使ってくださいね。テヘッ。

■使い方
　　１．exedit.auf（拡張編集プラグインのフィルタファイル）を置いたフォルダに「script」というフォルダを作ります。
　　２．同梱のanmファイル（*.anm）を、scriptフォルダの中に置きます。
　　３．AviUtlを起動し、拡張編集上のオブジェクトに「アニメーション効果」のフィルタ効果を追加すると、
　　　　左下の選択ボックスで下に示すアニメーションパターンが選択できるようになります。

　　※「TA」で始まるものは、テキストオブジェクトで「文字毎に個別オブジェクト」を
　　　 チェックして使うことを前提としています。
　　　 TAは多分Text Animationのことかな？
　　　 さつきさんのユーザ記事にあるサンプルスクリプトで「TA個別」という表現がされていたのでそれに倣いました。

　　※多角形配置のように３Ｄ的な描画を行なうアニメーション効果をかける場合、
　　　　オブジェクトは標準描画ではなく「拡張描画オブジェクト」にしておく必要があります。

　　※３Ｄ的な描画を行なうアニメーション効果を使う場合は、オブジェクトの上に
　　　　「カメラ制御（拡張描画）」を追加しないと、３D的な前後関係が正しく処理されません。

　　※作成した螺旋や多角形全体を傾けたりしたい場合は「グループ制御」を使うとよいと思います。
　　　　オブジェクト自体の回転などを使うと思ったようにいかない場合があります。
　　　　（オブジェクト自体の回転をいじると、それはそれで面白い効果が出せますが。）

■タイムライン上での基本的なレイヤー配置とフィルタ適用図

　　●カメラ制御(拡張描画)
　　●グループ制御
　　　　　下の対象オブジェクトとグループ化しておくとよい。
　　　　　全体の移動・回転などに使う。
　　●対象オブジェクト
　　　　　◎拡張描画オブジェクトにする。
　　　　　◎テキストの場合は基本的に位置揃えを「中央揃え[中]」にしておく。
　　　　　　　また、必要に応じて「文字毎に個別オブジェクト」にチェックを入れる。
　　　　　◎「多角柱マッピング」の場合は、ダミーの画像オブジェクトを使うとよい。
　　　　　◎必要に応じて「カメラ制御オプション」フィルタを追加する。
　　　　　　　（「カメラのほうを向く」を使いたい場合のみ。）
　　　　　◎「アニメーション効果」フィルタを追加し、アニメーションを選択。
　　　　　　　多角形配置などは複数のアニメーションを組み合わせて使うので、
　　　　　　　複数のアニメーション効果を追加する。
　　●デバッグ出力用テキストオブジェクト
　　　　　デバッグ出力を行なう場合のみ使用。


■各anmファイルと、それにより追加されるアニメーションパターン

　※必要なものを取捨選択して使ってください。
　　　特に「GH各種調整用.anm」は、細々とした単純設定用のセットなので、
　　　入れるとアニメーションのパターンが増えすぎて選ぶのが面倒になるかも。

　●GHスケール.anm
　　　「XYスケール」

　●GHデバッグ用.anm
　　　「dbg1」
　　　「dbg2」

　●GH円軌道配置.anm
　　　「円軌道配置」

　●GH各種調整用.anm
　　　「座標シフト」
　　　「回転シフト」
　　　「座標上書き(軸指定)」
　　　「回転上書き(軸指定)」
　　　「回転上書き(３軸)」
　　　「TA座標ずらし」
　　　「TA回転ずらし」
　　　「TA座標ずらし(現在値基準)」
　　　「TA回転ずらし(現在値基準)」
　　　「TAズームずらし(現在値基準)」
　　　「TA透明度ずらし(現在値基準)」

　●GH多角形配置.anm
　　　「多角形配置-1(定義のみ)」
　　　「多角形ずらし設定」
　　　「多角形配置-2(描画)」

　●GH螺旋配置.anm
　　　「螺旋-1(定義のみ)」
　　　「螺旋-2(描画)」
　　　「TA個別螺旋-1(定義のみ)」
　　　「TA個別螺旋-2(描画)」

　●GH球状配置2.anm
　　　「GH球状配置2-1(定義のみ)」
　　　「GH球状配置2-2(描画)」

　●GH多角柱マッピング.anm
　　　「多角柱マッピング基本設定」
　　　「多角柱テキスト設定」
　　　「多角柱図形設定」
　　　「多角柱輪切り設定」
　　　「多角柱輪切りずらし設定」
　　　「多角柱マッピング（縦）」
　　　「多角柱マッピング（横）」

　●GH3Dリピート.anm
　　　「3Dリピート基本設定」
　　　「3Dリピート相対回転設定」
　　　「3Dリピート相対拡縮・不透明度設定」
　　　「3Dリピート描画」


■それぞれのアニメーションについて

　※重要
　　　変化させたいパラメータが多いため、
　　　　　「多角形配置」「螺旋」「球状配置」「多角形マッピング」「3Dリピート」
　　　は、複数のアニメーションを組み合わせて使う必要があります。
　　　例えば「多角形配置」なら、
　　　　　１．まず「多角形配置-1(定義のみ)」のアニメーションを適用する。
　　　　　２．必要ならば「多角形ずらし設定」のアニメーションを適用する。
　　　　　３．最後に「多角形配置-2(描画)」のアニメーションを適用すると、
　　　　　　　実際の描画処理が行なわれる。
　　　という感じになっています。

　※ワンポイント
　　　「多角形配置・螺旋・円軌道・球状配置・多角柱マッピングで、面は必ずカメラのほうを向くようにしたい」という場合は、
　　　「向き」を「0」にしておき、オブジェクトに「カメラ制御オプション」を適用して「カメラのほうを向く」にしておきます。


　●XYスケール
　　　オブジェクトの拡大縮小を行ないます。
　　　X方向とY方向とで異なる比率の拡大縮小をしたい場合に使います。
　　　（「拡大率＋縦横比」での操作が面倒なのでパーセントで指定できるようにしたものです）

　　　　　パラメータ説明
　　　　　　　◎Xスケール
　　　　　　　　　X方向への拡大率をパーセントで指定します。
　　　　　　　◎Yスケール
　　　　　　　　　Y方向への拡大率をパーセントで指定します。

　●dbg1
　●dbg2
　　　lua.txtにある、各種パラメータ（obj.oxなど）をテキストで出力するためのものです。
　　　適用してもdbg1あるいはdbg2という変数を定義するだけなので何も起きませんが、
　　　下のレイヤーに出力用のテキストオブジェクトを追加し、テキスト部に
　　　　　<?mes(dbg1)?>
　　　もしくは
　　　　　<?mes(dbg2)?>
　　　と記述すると、オブジェクトの各種パラメータを見ることができます。

　●円軌道配置
　　　オブジェクトを円軌道に配置します。
　　　オブジェクトの「*軸回転」で自転を制御し、「回転」で公転を制御します。

　　　　　パラメータ説明
　　　　　　　◎軸
　　　　　　　　　円軌道の軸を指定します。
　　　　　　　　　　　0・・・X軸
　　　　　　　　　　　1・・・Y軸
　　　　　　　　　　　2・・・Z軸
　　　　　　　◎向き
　　　　　　　　　配置時のオブジェクトの向きを指定します。
　　　　　　　　　　　0： 面の向きを指定しません
　　　　　　　　　　　1： 面は円軌道の外側を向きます
　　　　　　　　　　　2： 面は円軌道の内側を向きます
　　　　　　　◎半径
　　　　　　　　　円の半径をピクセル数で指定します。
　　　　　　　◎回転
　　　　　　　　　円軌道上の回転を角度で指定します。


　●座標シフト
　●回転シフト
　●座標上書き(軸指定)
　●回転上書き(軸指定)
　●回転上書き(３軸)
　●TA座標ずらし
　●TA回転ずらし
　●TA座標ずらし(現在値基準)
　●TA回転ずらし(現在値基準)
　●TAズームずらし(現在値基準)
　●TA透明度ずらし(現在値基準)

　　　　→ox,oy,oz,rx,ry,rz,zoom,alphaを調整するために作ったものです。
　　　　　 TAで始まるものはobj.indexを考慮して値をずらします。
　　　　　 他のアニメーションを適用した後でこれらを適用して調整したりすると
　　　　　 微妙に面白いかもなーみたいな。


　●多角形配置
　　　オブジェクトを多角形状に配置します。
　　　　　　「多角形配置-1(定義のみ)」
　　　　　　「多角形ずらし設定」
　　　　　　「多角形配置-2(描画)」
　　　の３つのアニメーション効果を組み合わせて使います。
　　　基本的には、「多角形配置-1(定義のみ)」＋「多角形配置-2(描画)」の２つを
　　　順番に適用すれば動作します。
　　　多角形を繰り返し描画する際にピースの位置や半径をずらしたい場合のみ、
　　　「多角形配置-1(定義のみ)」と「多角形配置-2(描画)」との間に「多角形ずらし設定」を追加して使います。

　　　パラメータ説明

　　　　●多角形配置-1(定義のみ)
　　　　　　　◎繰り返し
　　　　　　　　　多角形描画の繰り返し回数を指定します。
　　　　　　　◎隙間
　　　　　　　　　多角形描画を繰り返す際の、多角形同士の隙間の大きさをピクセル数で指定します。
　　　　　　　◎捻り
　　　　　　　　　多角形描画の繰り返しごとの回転変化量を指定します。
　　　　　　　◎向き
　　　　　　　　　多角形を構成する面の向きを指定します。
　　　　　　　　　　　0： 面の向きを指定しません
　　　　　　　　　　　1： 面は多角形の外側を向きます
　　　　　　　　　　　2： 面は多角形の内側を向きます
　　　　　　　◎kijun（繰り返し時の基準）
　　　　　　　　　多角形を繰り返し描画する場合に、その基準を指定します。
　　　　　　　　　　　0：上基準or左基準
　　　　　　　　　　　1：中央基準
　　　　　　　　　　　2：下基準or右基準
　　　　　　　　　例えば「縦方向に並べる」にチェックが入っていない状態で0（上基準）にした場合、
　　　　　　　　　最初の多角形の位置を基準として、下方向に多角形が繰り返し描画されていきます。

　　　　●多角形ずらし設定
　　　　　　　◎X差
　　　　　　　　　ある多角形ピースから見た、「繰り返し軸のプラス方向にあるピース」の相対X座標を表します。
　　　　　　　◎Y差
　　　　　　　　　ある多角形ピースから見た、「繰り返し軸のプラス方向にあるピース」の相対Y座標を表します。
　　　　　　　◎Z差
　　　　　　　　　ある多角形ピースから見た、「繰り返し軸のプラス方向にあるピース」の相対Z座標を表します。
　　　　　　　◎半径差
　　　　　　　　　ある多角形ピースから見た、「繰り返し軸のプラス方向にあるピース」の相対半径差を表します。

　　　　●多角形配置-2(描画)
　　　　　　　◎Ｎ角形
　　　　　　　　　多角形の面の数を指定します。
　　　　　　　◎表示個数
　　　　　　　　　多角形の面のうちいくつを表示するかを指定します。
　　　　　　　◎半径調整
　　　　　　　　　多角形の外接円の半径をピクセル数で調整します。
　　　　　　　◎回転
　　　　　　　　　多角形を回転させます。
　　　　　　　◎縦方向に並べる
　　　　　　　　　チェックが入っている場合は、オブジェクトの高さを基にして縦につなげた多角形を構成します。
　　　　　　　　　デフォルトではチェックは入っておらず、オブジェクトの幅を基にして横につなげた多角形が構成されます。

　●螺旋
　　　オブジェクトを螺旋状に配置します。

　　　　　パラメータ説明
　　　　　　　◎軸
　　　　　　　　　螺旋の中心軸を指定します。
　　　　　　　　　　　0： X軸
　　　　　　　　　　　1： Y軸
　　　　　　　　　　　2： Z軸
　　　　　　　◎向き
　　　　　　　　　螺旋を構成するオブジェクトの向きを指定します。
　　　　　　　　　　　0： 面の向きを指定しません
　　　　　　　　　　　1： 表面を円の外側に向ける（軸がZの場合は上側を円の外側に向ける）
　　　　　　　　　　　2： 表側を円の内側に向ける（軸がZの場合は上側を円の内側に向ける）
　　　　　　　◎初期半径
　　　　　　　　　螺旋の初期半径をピクセル数で指定します。
　　　　　　　◎半径差分
　　　　　　　　　オブジェクト１つごとに半径の変化量をピクセル数で指定します。
　　　　　　　◎zoom（「設定」欄で指定）
　　　　　　　　　オブジェクト１つごとの拡大率の変化量をパーセントで指定します。
　　　　　　　　　マイナス値を指定すると徐々に小さくなります。
　　　　　　　◎alpha（「設定」欄で指定）
　　　　　　　　　オブジェクト１つごとの透明度の変化量をパーセントで指定します。
　　　　　　　　　マイナス値を指定すると徐々に透明になります。
　　　　　　　◎個数
　　　　　　　　　オブジェクトをいくつ描画するかを指定します。
　　　　　　　◎回転差分
　　　　　　　　　オブジェクト１つごとの回転の変化量を指定します。
　　　　　　　◎座標差分
　　　　　　　　　オブジェクト１つごとの「軸向きの座標値の変化量」をピクセル数で指定します。
　　　　　　　◎回転
　　　　　　　　　螺旋を回転させます。
　　　　　　　◎回転に同期して軸方向に移動
　　　　　　　　　チェックを入れると、回転を変化させるだけで、
　　　　　　　　　それにあわせて軸方向に自動的に移動します。
　　　　　　　　　ドリル的な動きという感じ。

　●TA個別螺旋
　　　テキストオブジェクトの各文字を螺旋状に配置します。
　　　テキストオブジェクトで「文字毎に個別オブジェクト」にチェックを入れて使うことを前提としています。

　　　　　パラメータ説明
　　　　　　　→上の「螺旋」に準ずるので説明は省略します。

　●GH球状配置2
　　　オブジェクトを球状に配置します。
　　　従来の「GH球状配置」では、オブジェクトを球面法線方向に向けることができませんでしたが、
　　　AviUtl作者のKENくん氏が、AviUtl愛好会コミュ掲示板の>>241に、
　　　「球面の法線に向けて並べるスクリプト」を投稿して下さったので、それを取り入れて機能拡張しました。
　　　投稿ありがとうございます。
　　　従来の「GH球状配置」とは違い、左に90度回転させた状態で球を形作ります。
　　　直立させたい場合はグループ制御のZ回転を使って下さい。
　　　また、「GH球状配置」の時にくらべ、配置座標やリサイズ、両極の扱いなどを少し変更しています。

　　　　　パラメータ説明
　　　　　　　◎極スケール
　　　　　　　　　赤道上のオブジェクトのサイズを100%と考えた場合の両極のオブジェクトのスケールをパーセントで表す。
　　　　　　　　　極と赤道の間のオブジェクトは、「極スケールの値〜100%」の間で段階的にリサイズされる。
　　　　　　　　　オブジェクトを同じ大きさで並べると極に近いほどオブジェクトが密集するので、
　　　　　　　　　それなら極に近いほどリサイズで小さくして密度を緩和してみるか〜というのが目的。
　　　　　　　◎Xスケール・Yスケール・Zスケール
　　　　　　　　　配置座標値のスケーリングを行ないます。オブジェクトのサイズや角度には影響しません。
　　　　　　　◎両極のオブジェクトも描く
　　　　　　　　　両極（北極と南極）のオブジェクトも描画するようにします。
　　　　　　　　　GH球状配置2では、両極のオブジェクトも「向き」や「自転」の影響を受けるようになりました。
　　　　　　　　　両極は描かないほうが自然な場合も多いので、デフォルトではOFFにしています。
　　　　　　　◎経線頂点
　　　　　　　　　経線上のオブジェクトの数。（両極のオブジェクトは含めません。）
　　　　　　　◎緯線頂点
　　　　　　　　　緯線上のオブジェクトの数。
　　　　　　　◎半径
　　　　　　　　　球の半径。
　　　　　　　◎自転
　　　　　　　　　両極を結ぶ軸での回転です。
　　　　　　　　　GH球状配置2では、両極のオブジェクトも自転の影響を受けるようになりました。
　　　　　　　◎dir（オブジェクトの向き）
　　　　　　　　　配置するオブジェクトの向きを指定します。
　　　　　　　　　GH球状配置2では、両極のオブジェクトも向きの影響を受けるようになりました。
　　　　　　　　　　　-1：指定無し（カメラ制御の「カメラのほうを向く」を使う場合はこれを指定して下さい）
　　　　　　　　　　　0：正面を向く
　　　　　　　　　　　1：軸の外側を向く
　　　　　　　　　　　2：軸の内側を向く
　　　　　　　　　　　3：球の外側を向く
　　　　　　　　　　　4：球の内側を向く


　●多角柱マッピング
　　　読み込んだ映像を、多角柱の表面に貼り付けるような形で描画します。
　　　多角柱の面の数を増やせば円筒に近い形状になります。
　　　　　　「多角柱マッピング基本設定」
　　　　　　「多角柱テキスト設定」
　　　　　　「多角柱図形設定」
　　　　　　「多角柱輪切り設定」
　　　　　　「多角柱輪切りずらし設定」
　　　　　　「多角柱マッピング（縦）」
　　　　　　「多角柱マッピング（横）」
　　　という７つのアニメーション効果を組み合わせて使用します。

　　　※ここまでのアニメーション効果は、オブジェクトそのものを使っていましたが、
　　　　　このアニメーション効果はファイルなどを直接指定して新たなオブジェクトを読み込み、
　　　　　そのオブジェクトに対して処理を行なうようになっています。
　　　　　具体的には
　　　　　　　１．obj.load()により、オブジェクト(テキスト、図形、静止画、動画、フレームバッファ)を読み込む。
　　　　　　　２．１で読み込んだオブジェクトに「クリッピング」を適用し、一部を取り出す。
　　　　　　　３．それを多角柱の一部として配置して描画する。
　　　　　　　４．１〜３を繰り返し、最終的に多角柱を構成する。
　　　　　という処理を行なっています。

　　　★ダミーの画像を読み込んで画像オブジェクトを作成して拡張描画オブジェクトにし、
　　　　、それに対してこのアニメーション効果を適用するのを推奨します。
　　　　　実際に使われるのはtypeとvalというパラメータで指定した映像ファイル等になります。
　　　　　適用対象となったダミーの画像は描画されません。
　　　　　（図形オブジェクトなどに適用してもよいのですが、画像を推奨する理由は、
　　　　　　適用できるアニメーション効果の数が変わってくるからです。
　　　　　　図形の場合は４つが限界ですが、多角柱をフルに制御しようとするには最大５つ必要なので、
　　　　　　図形オブジェクトだと足りなくなることがあります。
　　　　　　画像なら５つ適用できるので、こちらを推奨しています。）

　　　※基本的には、
　　　　　　手順１．ダミーの画像をタイムラインに追加し、画像オブジェクト（拡張描画）にする。
　　　　　　手順２．「多角柱マッピング基本設定」を適用する。
　　　　　　手順３．typeとvalで、読み込みたい動画ファイル等を指定する。
　　　　　　手順４．「多角柱マッピング(縦)」または「多角柱マッピング(横)」を適用する。
　　　　 という手順で使用します。
　　　　 これ以外に
　　　　　　　「多角柱テキスト設定」
　　　　　　　「多角柱図形設定」
　　　　　　　「多角柱輪切り設定」
　　　　　　　「多角柱輪切りずらし設定」
　　　　 というアニメーション効果がありますが、これらは必要に応じて手順４の前に適用して下さい。

　　　★上に書いたように、ファイルなどを何度も読み込みクリッピング処理するというのを繰り返しています。
　　　　　読み込み回数は、「分割数×輪切り数＋１」になります。
　　　　　つまり、例えば640×480の動画ファイルを指定し、７分割×７輪切りにすると、
　　　　　　　　「640×480の動画オブジェクトを５０個並べたのと同じくらいの負荷」
　　　　　が発生します。
　　　　　むやみに分割数や輪切り数を増やすとフリーズしかねないので、
　　　　　扱いには十分注意するようにしてください。

　　　※処理の関係上、読み込むオブジェクトのサイズの縦横が1000以内でないと
　　　　　正常に動作しないことがあります。
　　　　　これは「クリッピング」のパラメータの上限値が1000であることに由来します。

　　　パラメータ説明

　　　　　●多角柱マッピング基本設定
　　　　　　　◎再生位置
　　　　　　　　　動画ファイルを読み込む場合の再生開始位置を秒数で指定します。
　　　　　　　◎不透明度
　　　　　　　　　読み込んだオブジェクトの不透明度を指定します。
　　　　　　　　　0で完全透明、100で完全不透明になります。
　　　　　　　◎縦横比
　　　　　　　　　読み込んだオブジェクトの縦横比を指定します。
　　　　　　　◎type、val
　　　　　　　　　obj.load()の基本引数を表します。

　　　　　　　　　typeには読み込むオブジェクトの種類を指定します。
　　　　　　　　　text、figure、image、movie、framebufferの５種類が指定できます。
　　　　　　　　　とりあえずobj.load()で指定できるものは指定できるようにしましたが、
　　　　　　　　　このアニメーション効果の場合、framebufferは使うべきではないかも・・・。
　　　　　　　　　また、textやfigureも、たいていは「TA個別螺旋」「多角形配置」などを
　　　　　　　　　使ったほうがよい場合が多いと思います。

　　　　　　　　　valには読み込むオブジェクトの名前やファイル名を指定します。
　　　　　　　　　ファイル名を指定する場合、パス表記の「\」の部分は２つ重ねて書くようにして下さい。
　　　　　　　　　なお、typeとvalを記述する「設定」欄には、文字数の上限が255バイトまでという
　　　　　　　　　制限がありますので、なるべく浅いパスにファイルを置くことをお勧めします。

　　　　　　　　　　　例１．テキストを読み込む場合
　　　　　　　　　　　　　　　　type="text";val="表示したい文字列";
　　　　　　　　　　　　　　 valには色やサイズ、フォントの制御文字も使えます。詳細はexedit.txtやlua.txtを参照。
　　　　　　　　　　　　　　　　type="text";val="<s48><#ffff00>サイズ48で黄色い文字列";
　　　　　　　　　　　例２．図形を読み込む場合
　　　　　　　　　　　　　　　　type="figure";val="円";
　　　　　　　　　　　例３．静止画を読み込む場合
　　　　　　　　　　　　　　　　type="image";val="D:\\imageSozai\\nonowa.png";
　　　　　　　　　　　例４．動画を読み込む場合
　　　　　　　　　　　　　　　　type="movie";val="D:\\movieSozai\\hachune.avi";
　　　　　　　　　　　例５．フレームバッファを読み込む場合
　　　　　　　　　　　　　　 ※フレームバッファの場合はvalは使われません。
　　　　　　　　　　　　　　　　type="framebuffer";val="";

　　　　　　　　　　※上で書いたように設定欄には255バイト制限があるため、
　　　　　　　　　　　　valにあまり長い文字列を設定することはできません。
　　　　　　　　　　　　長い文字列を使いたい場合は、「多角柱マッピング基本設定」の
　　　　　　　　　　　　アニメーション効果の後に「スクリプト制御」のフィルタ効果を追加し、
　　　　　　　　　　　　　　val="<s16><#ffff00>よございますわ・・・あなたが何でもできるってんなら・・・まずはそのふざけたファンタジーをぶち殺してさしあげますわよ！オーッホッホッホッホー！"
　　　　　　　　　　　　といった感じで変数valを上書き定義してしまうという方法もあります。
　　　　　　　　　　　　ただし大きなフォントで長い文字列を使うとオブジェクトの幅が
　　　　　　　　　　　　簡単に1000を越えてしまうので注意して下さい。
　　　　　　　　　　　　「多角柱マッピング(縦)」あるいは「多角柱マッピング(横)」を適用した後、
　　　　　　　　　　　　下のレイヤーにテキストオブジェクトを作り、テキスト欄に
　　　　　　　　　　　　　　　<?=string.format("(幅, 高さ)＝(%d,%d)",clipW*cyl_div,clipH*cyl_cut)?>
　　　　　　　　　　　　と記述すると、多角柱マッピングで読み込んだオブジェクトの幅と高さをチェックできます。
　　　　　　　　　　　　これらの数値が1000を越えると、正常に多角柱が構成されないことがあります。

　　　　　●多角柱テキスト設定
　　　　　　　※フォント名やサイズ、色などはvalに直接タグを指定することでも設定できます。
　　　　　　　　 特に、色の指定はタグでないと指定できません。
　　　　　　　　 つまり、タグ使えばほぼ十分なのでこのアニメーションを使うことはほとんどないと思われます。
　　　　　　　◎サイズ
　　　　　　　　　テキストのサイズを指定します。
　　　　　　　◎タイプ
　　　　　　　　　フォントタイプを指定します。
　　　　　　　　　拡張編集プラグインに同梱されているlua.txtのsetfont()のtypeに相当します。
　　　　　　　◎fontName
　　　　　　　　　フォント名を指定します。

　　　　　●多角柱図形設定
　　　　　　　※図形を多角柱にするということはあまりないと思うので、これも出番は少ないと思います。
　　　　　　　◎サイズ
　　　　　　　　　図形のサイズを指定します。
　　　　　　　◎ライン幅
　　　　　　　　　図形のライン幅を指定します。
　　　　　　　◎figColor
　　　　　　　　　図形の色を指定します。RGBを16進数で表現したものです。

　　　　　●多角柱輪切り設定
　　　　　　　◎輪切り数
　　　　　　　　　多角柱を輪切りにする場合の輪切りの数を指定します。
　　　　　　　　　1は輪切りにしないことを表します。
　　　　　　　　　以下、輪切りにした多角柱１つ１つのことを「多角柱ピース」と呼びます。
　　　　　　　◎隙間
　　　　　　　　　輪切りにしたものの間隔を指定します。
　　　　　　　◎捻り
　　　　　　　　　ある多角柱ピースから見た、「軸のプラス方向にあるピース」の相対回転差を表します。
　　　　　　　◎半径差
　　　　　　　　　ある多角柱ピースから見た、「軸のプラス方向にあるピース」の相対半径差を表します。
　　　　　　　◎kijun（輪切り制御の基準）
　　　　　　　　　輪切りにしたものの捻りや半径差、XYZ差を設定する場合の、基準となる位置を指定します。
　　　　　　　　　　　　0：上基準or左基準
　　　　　　　　　　　　1：オブジェクト中央基準
　　　　　　　　　　　　2：下基準or右基準
　　　　　　　　　例えば「多角柱マッピング(縦)」において上基準を選び、隙間を設定すると、
　　　　　　　　　一番上の多角柱ピースは動かず、その下のピースがずれていきます。

　　　　　●多角柱輪切りずらし設定
　　　　　　　◎X差
　　　　　　　　　ある多角柱ピースから見た、「軸のプラス方向にあるピース」の相対X座標を表します。
　　　　　　　◎Y差
　　　　　　　　　ある多角柱ピースから見た、「軸のプラス方向にあるピース」の相対Y座標を表します。
　　　　　　　◎Z差
　　　　　　　　　ある多角柱ピースから見た、「繰り返し軸のプラス方向にあるピース」の相対Z座標を表します。

　　　　　●多角柱マッピング(縦)、多角柱マッピング（横）
　　　　　　　◎分割数
　　　　　　　　　多角柱の面の数を指定します。5なら５角柱となります。
　　　　　　　◎表示個数
　　　　　　　　　多角柱の面の表示個数を指定します。通常は分割数よりも大きな値にしておいて下さい。
　　　　　　　◎半径調整
　　　　　　　　　多角柱の外接円の半径を調整します。
　　　　　　　◎回転
　　　　　　　　　多角柱を中心軸を中心に回転させます。
　　　　　　　◎cyl_dir（面の向き）
　　　　　　　　　多角柱の面の向きを指定します。
　　　　　　　　　　　　0:向きの指定なし
　　　　　　　　　　　　1:オブジェクト表面を多角柱の外側に向ける
　　　　　　　　　　　　2:オブジェクト表面を多角柱の内側に向ける
　　　　　　　◎effect（描画時のフィルタ効果適用の有無）
　　　　　　　　　多角柱マッピングの描画を行なう際、このアニメーション効果の後に適用した
　　　　　　　　　フィルタ効果を適用するかどうかを指定します。
　　　　　　　　　　　　0:アニメーション効果後のフィルタ効果は無視する
　　　　　　　　　　　　1:アニメーション効果後のフィルタ効果を適用してから描画する
　　　　　　　　　1にした場合、以下の流れで処理が進みます。
　　　　　　　　　　　　１．指定したオブジェクトを読み込む。
　　　　　　　　　　　　２．後のフィルタ効果を１に適用する。　←★ここを行なうかどうかの指定になります。
　　　　　　　　　　　　３．クリッピングで必要部分を切り出す。
　　　　　　　　　　　　４．多角柱の一部として配置する。
　　　　　　　　　　　　５．１〜４を繰り返し、多角柱を形成する。


　●3Dリピート
　　　オブジェクトを繰り返し描画します。
　　　繰り返し時のずらし方を相対的に設定することができます。
　　　　　「3Dリピート基本設定」
　　　　　「3Dリピート相対回転設定」
　　　　　「3Dリピート相対拡縮・不透明度設定」
　　　　　「3Dリピート描画」
　　　という４つのアニメーションを組み合わせて使用します。

　　　※最初に「3Dリピート基本設定」を適用し、その後「3Dリピート描画」を適用して下さい。
　　　　　繰り返し描画時の相対的な回転・拡縮・不透明度を細かく制御したい場合のみ、
　　　　　「3Dリピート基本設定」と「3Dリピート描画」の間に「3Dリピート相対回転設定」
　　　　　「3Dリピート相対拡縮・不透明度設定」の中の必要なものを適用してください。

　　　※以下の説明の「隣接映像」とは、
　　　　　「3Dリピート描画」で「間隔」をプラスにしたときに
　　　　　ある繰り返し要素から見て１つZ軸プラス側にある映像のことを指します。

　　　　　●3Dリピート基本設定
　　　　　　　※３Dリピートを使う場合は必ず適用して下さい。
　　　　　　　◎X差
　　　　　　　　　隣接映像の相対X座標を表します。
　　　　　　　◎Y差
　　　　　　　　　隣接映像の相対Y座標を表します。
　　　　　　　◎Z差
　　　　　　　　　隣接映像の相対Z座標を表します。
　　　　　　　　　この値と「間隔」の値との和が、実際のＺ方向の相対座標となります。

　　　　　●3Dリピート相対回転設定
　　　　　　　◎X回転差
　　　　　　　　　隣接映像の相対X回転を表します。
　　　　　　　◎Y回転差
　　　　　　　　　隣接映像の相対Y回転を表します。
　　　　　　　◎Z回転差
　　　　　　　　　隣接映像の相対Z回転を表します。
　　　　　　　　　この値と「捻り」の値との和が、相対的なＺ軸回転となります。

　　　　　●3Dリピート相対拡縮・不透明度設定
　　　　　　　※オブジェクトの透明度をあげて半透明にしていた場合、
　　　　　　　　　それ以上に不透明にすることはできません。
　　　　　　　◎拡縮差
　　　　　　　　　隣接映像の相対的な拡大・縮小の差を表します。
　　　　　　　◎基本透度
　　　　　　　　　基準位置のオブジェクトの透明度を表します。
　　　　　　　　　0で完全透明、1で最大不透明になります。
　　　　　　　◎不透明差
　　　　　　　　　隣接映像の相対的な不透明度差を表します。

　　　　　●3Dリピート描画
　　　　　　　◎繰り返し
　　　　　　　　　描画を繰り返す回数を指定します。
　　　　　　　◎間隔
　　　　　　　　　繰り返し描画時のＺ軸方向の間隔を指定します。
　　　　　　　　　この値と「Ｚ差」の値との和が、実際のＺ方向の相対座標となります。
　　　　　　　◎捻り
　　　　　　　　　繰り返し描画時の相対的なＺ軸回転を指定します。
　　　　　　　　　この値と「Ｚ回転差」の値との和が、相対的なＺ軸回転となります。
　　　　　　　◎回転
　　　　　　　　　基準位置の映像をＺ軸回転させます。
　　　　　　　　　これにともない全体が回転することになります。
　　　　　　　◎kijun（繰り返しの基準）
　　　　　　　　　繰り返しを行なう場合の繰り返し方を指定します。
　　　　　　　　　　　0：Ｚ軸プラス方向に繰り返す
　　　　　　　　　　　1：原点を基準とし、Ｚ軸プラスマイナス両方向に繰り返す
　　　　　　　　　　　2：Ｚ軸マイナス方向に繰り返す


■「古いもの」フォルダについて

　以前のリリースに含めていたものを同梱してあります。
　機能拡張や正式版のリリースにより不要になったものですが、
　これらを使って作ったプロジェクトも開けるようにするための措置です。
　必要な方だけ入れるようにしてください。
　基本的には使わないようにして下さい。

　●GH球状配置.anm
　　　「GH球状配置-1(定義のみ)」
　　　「GH球状配置-2(描画)」

　　　　◎GH球状配置
　　　　　　オブジェクトを球状に配置します。
　　　　　　GH球状配置2とは違い、直立した形で球を形作りますが、
　　　　　　オブジェクトを球面の法線に向けることはできません。
　　　　　　使い方は、GH球状配置2とほぼ同じです。

　●GH多角柱マッピングお試し版.anm
　　　「多角柱マッピングお試し版」

　　　　◎オブジェクトを読み込み多角柱にマッピングしたような形で描画します。
　　　　　　縦の多角柱のみです。輪切りなどはできません。


■同梱のaupファイルについて
　　AviUtlのサンプルプロジェクトですが、他の方の環境で開けるのかはよくわかりません。


■参考サイト

　●AviUtlのお部屋（AviUtl、拡張編集プラグイン）
　　　　http://spring-fragrance.mints.ne.jp/aviutl/

　●ニコニコ動画「AviUtl愛好会」コミュニティ
　　　　http://com.nicovideo.jp/community/co556462

　●ニコニコ動画のさつきさんのユーザ記事
　　　　http://dic.nicovideo.jp/u/2787743

　●2chYoutube板　AviUtl拡張編集Pluginスレッド Part3
　　　　http://hibari.2ch.net/test/read.cgi/streaming/1292504116/l50


■動画作りにあわせてオススメ

　●NicoVisualEffects2（NiVE2）
　　　　http://nive.jp/NiVE2

　フリーソフトで動画を作るなら、AviUtl＋拡張編集と、NiVE2をいいとこどりして使うのがオススメ！


■ものすごくどうでもよいQ&A

　Ｑ．ファイル名とかについてる「GH」ってなにさ？
　Ａ．作者名である「金の髭」をGoldenHigeというイミフなアルファベットつづりにしたものの省略形。

　Ｑ．なんでわざわざファイル名とかに「GH」ってつけてんの？自己主張して目立ちたいの？うざいよ？
　Ａ．単純に「螺旋配置.anm」とかにしてもよいのですが、GHってつけておけば
　　　私が配布したものだということが明示されるので、質問受付時とかにわかりやすいかなと。
　　　また、アニメーションは
　　　　　「アニメーション名@ファイル名」
　　　で識別されるようですので、ファイル名やアニメーション名にGHってつけとけば、
　　　他の人が別途「螺旋配置.anm」を作って配布したとしても、それと共存して使うことができるというメリットもあります。
　　　球状配置についてはとらまたさんが既に「球状配置」という名前でアニメーションを公開しておられたので
　　　それと区別するためにアニメーション名にもGHをつけてみました。


■改造や再配布について

　●ライセンスも何もないけど敢えて言葉にするなら煮るなり焼くなり好きにして
　　 むしろ変なとこはニコニコAviUtl愛好会コミュの掲示板あたりで指摘してくださいっていうか
　　 ベターな実装があれば積極的に改造するなり新しく作るなりして配布してくださいお願いしますライセンス？

　●ただし、改造して配布したりする場合はセット名やファイル名から「GH」を削ってください。
　　 上のQ&Aに書いたように、「GH」は私が配布したものであるということを明示する意味合いを持っているので。


■更新履歴

　●2011/03/07
　　　・拡張編集のバージョンを0.87eから0,87fに。
　　　　「多角柱マッピング」は0.87eでは動作しません。
　　　　また0.87fで描画品質が大幅に改善されたので他のアニメーションでも0.87fの使用を推奨。
　　　・「@GH多角形配置.anm」に、「多角形ずらし設定」のアニメーションを追加。
　　　　また、「多角形配置-1(定義)のみ」に、kijun（繰り返し時の基準）を追加。
　　　・「@GH多角柱マッピング.anm」を追加。
　　　・「@GH3Dリピート.anm」を追加。

　●2011/02/18
　　　・拡張編集のバージョンを0.87dから0.87eに。
　　　　ただし0.87eでの新機能は使っていないので0.87dでも動作するはずです。
　　　・「@GH球状配置2.anm」を作成して追加。
　　　　AviUtl作者のKENくん氏が、AviUtl愛好会コミュ掲示板の>>241に、
　　　　「球面の法線にそって並べるスクリプト」を投稿してくださったので、それを取り入れて拡張したものです。
　　　　従来の球状配置とは異なり、計算の都合上、左に90度回転した形で球を形づくります。
　　　　また、配置座標や両極の扱いなどが微妙に変わっています。
　　　・「@GH球状配置2.anm」の追加にともない、従来の「@GH球面配置.anm」を
　　　　「古いもの」フォルダに移動。基本的には2のほうを使えばよいのですが、
　　　　従来のものを使って作ったプロジェクトを開きたい場合に必要になるので一応同梱しておきます。

　●2011/02/13
　　　・AviUtl愛好会コミュで「とらまた」氏が公開していた「球状配置」をベースに
　　　　「@GH球状配置.anm」を作成して追加。
　　　・readmeの記述をもろもろ更新。

　●2011/02/11
　　　・「GHデバッグ用.anm」を入れ忘れていたので追加。
　　　・「注意」の記述を追加。
